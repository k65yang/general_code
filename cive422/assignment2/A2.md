# Question 4

## Part b)
Figures showing the displacement and strain using 4 quadatic elements is shown below.  

![](https://lh3.googleusercontent.com/a2kFl6xA4rr25PF3457lAP2cWVrueEcfJM7tzU3hqu7fY7E3Nz-PvmN8I_pK6QwL1MqJfionwyFw4YZERb6myJzLMkWDmePd1J5FTHClgL17yuq66BlSKpU6Ancdd4YnLzH8R01vCoFsQSs3Fk5ubYVgzxkGgchtpxyvqcjXQBvNiaD1XNapd6laZulT3_CnQMuumXS17MCh62wT1WyS0DeUgQpl_9dLU5EumkIYZzj29EiM-Mk5auw8JsNW9y8OIK7dpIinGHrhFceFH_GxBrFMoGkHL-T-qfAMGd5kW5Rjmmbq7ub7QENpSlFeWpiu6DZeqfha7qOfR-5W8DqLvd5DYXEbqBv-pYgI3SAceeBjXhJt3li9PdwilBAxn7JJF_FWrFO57GsF5r9VbWJLnHUo8jrcQFBpirEH3D6-ELZNv3WeOVIyBeEdg2kQVdtd1PVC0IvBhhcvK-cyfqV6BJZ4aF6yHoAClvBNx1ceOz16jT0bVNHVVJZmnwn7lIMZomMGHl_Akh_KI48WQC4nalWCclJR68UAhFovvbJjcG2rA99FF72ZiATMTRWwl2c87P9HRPcqLWndln4r50ENfI1CoOpO7GVMVbcRqQyPGrQwYS3w5guCoDi89pka1Dytf46jkJoWKEOVMSKwjPW01pcJg6C6fT_0yii6pgYx5Ca2Br1xFt1pXQ=w560-h420-no)  

![](https://lh3.googleusercontent.com/LqbxWhkxiR85uo7shFduoMb7Edu8UgFbMP1CAwYH5BYztFr8oa0ZPvq4PwhVk1TuW5bKBHVJxzQe_o592KbRcUiVlGy_L4p2FMF9DYhscWpqPEn64G6JKNe20e_ZX3KUC8493BUTsdR28R7ATnfYpyPBwhfxDAaGK8sUVJNj1vD5Sc4LguvNKHCYwjgjRE9jcXRGGh_F3zcZ_g9UWf5Hj6E6lY6OEs7Czk06TrYFpzzpmff881rps6gf1LSaNJm-VFsLCxxrDzdLnvpyXkHAvaVKkyiEp01RxRwxtvM3B8CPnTRXIUPev9kRVyy47eU3IfCNTIKRjcvsAULhTJRwWgqxfmYEJBT1ERon45uxnPtRBDBCTNHpRyb-8Ta_-GtCLR34OpxXXVtv2QVmznayRZqxJv9kSwOtXoedUu84njAjpZnSEuO_1RmjUdI3jzyDRljf9lUPyMpvsjQpogVuTGqDDvjBJn3IKYLCbEuQcMs1X0GG_9thR9DHh-GvnUr4heDKaSAge9h0ktcFEcORKsCu-n7M3HrTtTnnJyOBc4dH8qNvNpez4VKyDG0LOwtsdn6PKydyVYg4SUPYhylXXQbVXewWOW7icV-UyrtNhxAVfG6_EtAYIxvGyL616QBeuNWkaNrX_KvNL13H7aBtqXByOgO2PV8YWMZbbmxIFDgI64xOU0K0wQ=w560-h420-no)  

Figures showing the displacement and strain using 8 quadatic elements is shown below.  

![](https://lh3.googleusercontent.com/u5gJXM1X7ZatuG8nKeS_LDdjP74yOz7-wS1iVsOoIo1uxwrS1d6XWnan_X_d9ZpF2H6f3eYUooUAHhgb94WdK-c4DBYrR4NB8it1MkP3CSX9XtzXpa8_q_Ruo3L8BE2act7_YmoOKdYwquqEV4P_vNflyPCn-FHZYXhoFtGyrZOCXENUaoh8Dp4H37JluzBn-Iay_jYmnvNDnHw_6kDsx9-Jn2nKrdta7jMA8Ocs0Wci6hbnmOjFRB5BGP-edJ9NCWOkBSFbEZ7fuMWHoEB8GHt1uYeTacwy9xB7zf0AcwPtJ3XMi78xdx2gNz-jCnjZt5g08-fyxvjXXpm22FqOAM_ue4rL4PiLNbA1-CbPpgYnX81bzzK5chZMWCae-R4ttfyu3PdvSzuDsGMN0XTn28Wtiq8-n0J76oiu4lgfJ2YOYg0XRNPWsGAUf4_4KGyMWfYZ3T1OINzIPfQfkvJrLnD8t7qYLnSVVx89BzhEdz44M_VXx3fAFPU0drDPenkr_HOfKvOnRN1s8HRBTVnBIScybOaQCnXqqrP4cRb8ppMFGUVw8ILhVG6xYihJhPAwRKj4_HfN--vCTRYq7pGb-cjrfS1dbHuD-PtFfxESlZaOm8B8-dGfxdCVAB4cl22RMTQ9_usDj6nv3h8US6nLz0Q5NgvBRDmfwscPYC7tSm9ik6D3mLvZVg=w560-h420-no)  

![](https://lh3.googleusercontent.com/rTY4NJ1R67Amo2dqG72EcQlKzL-0p82gwppBB7UJX7aKI6cpJxPHWNJnXTPbL9wkQEnoesQgioCL-LExICBQUQnF-yTDEC_RQcjX72Yby_mXrxXzTwC_LjHKZfcJiTw7YezOFDgaaOmMq4iRlOpJE7-5-quBr6xWQtxIsXZ6jO-L2JED3MQzha-S2NWIhk0tRo0AB80ZjuiDPEL79tvzilpMWpz0lErXmOhVvVISnL8LDR4UPg6jNSrrFWTN8Xu_m3hpNGSZZlHzABftJNm8YFy8lMI9fGHJeK25MFIVFkbM5p7-Uqowt-s9vgb3Z1QYvZiy56bVkKUUReA83XzX2XPZsGd05jd_ztt3wQk03W2and3YNfxlwqG5myL_xRaSi07FYVUzExIAgbRQkzMctf_Z9qs2aLv3rNtNc3mzSDVGPBcNxA8Q7omWPO1L2CHIuf-HoIniOUpTZrTR8tvzDN2DDt-aUf3J3bSEO4K0kd3_hdDjT2vCav4EVMLj7hrxnKw9qRYDMZqQ2l2RIjuJcj-p95Y7X8iKfsqLPjxYi1tZLjqvnULW6y_TEB3mL9ytW9JNJXzpLqmA6VNecJP4hHMsN2lDxqfnGWvKfJmUICDn9xZMkTXVH2V-iKejDr1iMfdg4n5E4jvZ3xyVOE6KcR5Is0s8SG9KIUf2g-IEDXDLw3q8wCyd7w=w560-h420-no)  

The modified code to compute strain using quadratic elements is presented as follows. Note that only functions that were adjusted are presented below. Minimal adjustments for mainprogram.m (changing number of elements) were made and not presented here for brevity.  

### function FEM1D
```matlab
function [ rel_err_u, rel_err_e ] = FEM1D( ne )
%% Define Geometry
L = 1;          % length of the domain

%% Define output flags
graphics =1;    % flag set to 1 if graphic output is desired

%% define mesh 
nn = 2*ne+1;      % number of nodes
dL = L/ne;      % element length
dn = dL/2;      % distance between nodes
nodes = 0:dn:L;         

% element connectivity
conn = zeros(ne,3);     
n = 1;
for e=1:ne
   conn(e,1) = n;
   conn(e,2) = n+1;
   conn(e,3) = n+2;
   n = n+2;
end
conn

%% initialize global matrices
K = sparse(nn,nn); % stiffness matrix
F = zeros(nn,1);   % force matrix
d = zeros(nn,1);    % nodal displacements


% build stiffness matrix and force vector
for e=1:ne 
    enodes=conn(e,:); % scatter vector (element nodes)
    x1 = nodes(enodes(1)); % coordinate of node 1
    x2 = nodes(enodes(2)); % coordinate of node 2
    x3 = nodes(enodes(3)); % coordinate of node 3
    b1 = BodyForceAt(x1);     % body force at node 1
    b2 = BodyForceAt(x2);     % body force at node 2
    b3 = BodyForceAt(x3);     % body force at node 3
    
    Ke = 1/12/dn*[14 -16 2;
                  -16 32 -16;
                  2 -16 14];  % element stiffness matrix
    
    Me = dL/30*[4 2 -1;
                2 16 2;
                -1 2 4];

    fe = Me*[b1; b2; b3];       % element nodal force vector 
    
    % Assemble element matrix and vector into global stiffness matrix and force vector
    K(enodes,enodes)=K(enodes,enodes)+Ke;
    F(enodes) = F(enodes)+fe;
end


%% apply traction bc's
 t = dudx(L);
 F(nn) = F(nn)+t;
 
% applied essential bc's
free_dofs = 2:nn;
fixed_dofs = 1;
d(fixed_dofs) = 2;

%% solve linear system of equations
KFF= K(free_dofs,free_dofs);
KFE= K(free_dofs,fixed_dofs);
fE = F(free_dofs);
dE = d(fixed_dofs);

d(free_dofs) = KFF\(fE-KFE*dE)


%% compute error in displacements at x=L
uh = d(nn);
u_ex = u(L);
rel_err_u = abs( (uh-u_ex)/u_ex );

%% compute error in the strain at x=1
strain_h = FEstrain(1,nodes,conn,d,L);
strain_ex = dudx(1);
rel_err_e = abs( ( strain_h-strain_ex )/strain_ex);



if graphics
    % array of equally spaced points between 0 and L where the exact and 
    % FEM solutions will be plotted.
    X=0:L/500:L;  
    % evaluate the exact solution at every point in array X.
    uexact = u(X);   
    % evaluate the FEM solution at every point in array X.
    uFE = FEdisp(X,nodes,conn,d,L) ; 
    % evaluate the gradient(strain) of the exact solution at every point 
    % in array X
    du_exact = dudx(X); 
    % evaluate the gradient(strain) of the FEM solution at every point
    % in array X
    dudxFE = FEstrain(X,nodes,conn,d,L);
    
    %plot results
 
    figure(1);
    plot(X,uexact,'-.b','linewidth',2);
    hold on;
    plot(X,uFE,'r');
    ylabel('{\fontsize{24}dislplacement}','linewidth',2);
    % legend ("EXACT","FEM");% uncomment if you use windows
    legend ('EXACT','FEM');% uncomment if you use mac
    % plot(nodes,d,'ro');
    print -depsc Disp.eps
    hold off;
    
    figure(2);
    plot(X,du_exact,'-.b','linewidth',2);   
    hold on;
    plot(X,dudxFE,'r','linewidth',2);
    ylabel('{\fontsize{24}strain}');    
    %legend("EXACT","FEM");% uncomment if you use windows
    legend('EXACT','FEM');% uncomment if you use windows
    print -depsc Strain.eps
    hold off;
end
```

### function FEdisp
```matlab
function uFE = FEdisp(X,nodes,conn,d,L)

% determines the FE displacement at each point in array X
nx = length(X);
nn = size(nodes,2); % number of nodes in the mesh
ne = (nn-1)/2;  % number of elements
dL = L/ne; % element length
dn = dL/2; % half of element size because quadratic
uFE = zeros(nx,1); % array where FE displacements at each point in X will be stored

% determin shape functions wrt to x
N1e = @(x_,x2,x3) 1/2/dn^2 * (x_-x2)*(x_-x3);
N2e = @(x_,x1,x3) -1/dn^2 * (x_-x1)*(x_-x3);
N3e = @(x_,x1,x2) 1/2/dn^2 * (x_-x1)*(x_-x2);

for ii = 1:nx
    x_val = X(ii);
    elnum = max(1,ceil(x_val/(dL)));
    nLocal = conn(elnum,:);
    x1e = nodes(nLocal(1));
    x2e = nodes(nLocal(2));
    x3e = nodes(nLocal(3));
    
    % Compute shape function at x(ii)
    u = [N1e(x_val,x2e,x3e) N2e(x_val,x1e,x3e) N3e(x_val,x1e,x2e)];
    de = d(nLocal);
    uFE(ii) = u*de;
end
```

### function FEstrain
```matlab
function gradu = FEstrain(x,nodes,conn,d,L)
% determines the FE strain at x
nx = length(x);
nn = size(nodes,2);
dn = L/(nn-1) % distance between nodes
gradu = zeros(nx,1);

% determine the derivatives of shape functions wrt x
B1e = @(x_,e) 1/2/dn^2 * (2*x_ - 3*dn - 4*(e-1)*dn);
B2e = @(x_,e) -1/dn^2 * (2*x_ - 2*dn - 4*(e-1)*dn);
B3e = @(x_,e) 1/2/dn^2 * (2*x_ - dn - 4*(e-1)*dn);

for ii  = 1:nx
    x_val = x(ii);
    elnum = max(1,ceil(x_val/(dn*2)));
    % Compute derivative at x(ii)
    dNdz = [B1e(x_val,elnum) B2e(x_val,elnum) B3e(x_val,elnum)];
    de = d(conn(elnum,:));
    gradu(ii) = dNdz*de;
end
```
## Part c

Graphs showing the convergence curves for displacement and strain at X=1 are presented in the following figures.  

![](https://lh3.googleusercontent.com/BCVoKybVoxN5zdaiAPQda2IkB83x1L93L8MRxJr2i2dVeQHynpDieXz1xQeKNDpQw8QvwXI0DenFDMsFR61aGScsjM_zwhivEYrRq3mA9AFqzk0TezMZBBqnna_QqvEqgafzYTQ3WKSQ6beVijQxymi5eSkOS_MmYEtKV_7uo4BtiXz10Y80YqjFLOtCKf7jDkVUF1r1B5hUSMajyMDXqgYeTHY3e6qLVzvruc0r716FFitFKfdx8J3ll5bgtgq05kP3pAJgmgyZtf3G5CeOoHJsQExGSW5QWYeWxcJ9XBwO4V6UMxqQqOpwNL2aZpB466boXu-d4ydn2bmT7N_0eq6I26dJ64NGAh37ofmpCz2gWvSscYtiVhn1REv5Lht5gEfDNxm-9f74yKkIA7RkaFrQT288R-OAjiyWWDUOAu-r0KEPWj5bH9gL0oH4fZRC83E5EPS3Vhk0hS1iTMl6Zzt0ZCrYFQE_BMaoum5u9Obja0ZtkSlvP7AIV46vcGu4a4yT6ZuSwlVhNl-65z160ZZcS0P_nFMW0o2oVC7KYjDrZowFi1ZJaoaVJcmk7iobm3O4QSALY_5xTeZr3MFZis7m6IzN9L9wa00Z-czXlYDXrspTCGS0GFv4Bril8yQJkJ2hGWwm1cYjw7V1nXMXbDDnyS1-8IWVDy9sfu_Up9TRVhrqDakKjA=w560-h420-no)  

![](https://lh3.googleusercontent.com/dJ2VxhgH5yQuhXc7mRu_mgo5nxBOMvy-13dJAKVs7sLPfqPQAW6QNy8PdGKGEH5-nOYYGRdLwZsxtTzpLY2okpkcldRnuH9UYFxaP2n3PN54D8-dK0sHyjTkhmh8mYfNh4inED5gizkNJUhQYDTEGozPhr08JrwFxk18J8aHgOMT5c6em61Vs4G45guosfzZiXG9wjsPaXEEtXDKD3VFX6-t8Q_ih_VPLc5F5maxUJOBo2hJqwbLF4f_S9FM6-k_bT1d085XQL3ALJ8T1OFQMsIYMnHQjHUVujDjzGrNgMmWOSEwvgeRy0EazDlCHJ0GQZvNfOHb3reox6RL6zE1AvI0bQZi_H2mt7m_4SlwwV7WwWXKsnxr0PguBbEuWJXonCbMddXsN5pUhMuv3Q_CObJIeyC75iXCNClOAJ3c3uvucwcxxW23ef_fJrNtcYTi0D90JO_3wmWaB96-S3yva1UKwKIT4VlvojzfFCiym_WJafjwHXGxfkK2P7WiDirVsbB7M5G-hel0fnNkfrYzajZu8J_-tYRcj5RRNvscJ8WPBTemKFNkQgpHbNNXumQflIVXB8ELs1R_yCzJ2KEjNQjty_KJGW99X379Gzs7yKCz34UxkUq1ZAsiT623XmYhna1k8bqYxZQtaojn7qByI6bQfIOCJI3CxbyZmW4qsIt0TYfRaSFdEA=w560-h420-no)  

# Question 5  

## Part a)

Plots of displacement and strain field for FEm approximation of 3 quadratic elements is shown below.  

![](https://lh3.googleusercontent.com/T5qVsq_14PyRRK9KLZT9I-ywoi07sw7uCfShZZamcDUj5oD3-BDFSNRnp7__g1eWMSsh2UcYkZCqjhDaepPV-Cgw1I1ngvfF128moFAhY58cqHRPgomya0kMZT-ZhnfKbXYSnxP9vy4TmVdVZ0HUNSqexcjIKC4aNsVH5RxBhq5K9p_9lq2a5o4exENHFfLfHhFH4peR1UPzOzE7zWrRGzGyqHd_absCJt3OjmzLHfcLAMp94dfD3G65iSKw9y30GZsPj1mh2rZEGtqOaDSN2g-T0SHxQucQWgy_rDs8gRxxcS4sc-SMSN1oWYNQxQfynGzWxsWg7XoaA88vCPZSiAcqTpWwm7dKV0Ghp7z3383wOVRoRVJxWAu5iDlvPO7_baxfMJi81TAXpBinp2EVUnXEtOgzj1lsKloaff2UJZ6izGv5hMTs22s6TEq1gUxJ7FRZ--bshi9FAhKbFVscQ_JgTNA8-Spk2rFKih0-LurJzVihnTWhdilJISOX2gCIu7RB162ZAtTy9ZZ899YgOmXvsN_3c6rXSrtJyY76JKPIrVuR-NQ-B1u_HAN-aWXdDMy7eCaFmQ-fWnm_wSxadpvgsSMugFGvXyCGv61S_pF-0MsXlKOnJuNWbCVoclqLfggmnQaoDb1T6HDftIZ1RMrb_uQEIcCsCXmn4zHWqA7AlIGCdfwXTg=w560-h420-no)  

![](https://lh3.googleusercontent.com/iu4gAoOmHTuLZ2Ci6aTdaAPY0btMw6mktSy4n9PuY3okUwrI36DA2olsJc9o8ifNVj4QTT-J-RlSx5B4U9guAPLUPsiCmoFuUVynb71ofq3KMJwMT_ZGMyGLTygBORzMUj6Gn0eKD5pwdHsp0bjQDK2hRIAX45P5866YIg9RvZ5o_Nvo2-d7jUwqfyXLoTb1N-mhrRPUCt5Q88JG4ft1JTcIL7OBMpdEREtV4DPMVQN-Ac9BeG55zvRJGGCaXJ--VWHQn9jIGF-dxtKDZDtZyGvMc8gmOHyJhBSZQuqdOCkal-qtnQGMJleNjbWacsuYdxmrqcsFEM8wpAD84KGfAoGh8RbMwma3QK40TBITU0kRA3MNr9gtvzoey3f3jYcGooqEbXiriIlwn3ta60i44mOiQrblNVgL7wc6-5x-3J-BL2p7ja_MSpbYlYfitGHd6mN7g-ZYFAy5uyhEyUN3cLwXIxzGuxqJckxTEjCJA7HLjUSHsXPOjdXESIrs--Rdm7XR7tj97CqSm8QUAkb0n6u21MLjVzVI0Hs2Rl5H3z5CsmlV_EjclEdB6JmIyE_guQwCicQe-bNOI7KDW_t2I8pqb6hyEG2Pil7w1_M0AL3cRAOeKUCXdU7rmZZMsYM7gTFTatf5Tx6zxEYfq-G5eaGkCpzBksUmfjFVOtgR0F-yDHutJq4MFg=w560-h420-no)  

Plots of displacement and strain field for FEM approximation of 3 quadratic elements is shown below.  

![](https://lh3.googleusercontent.com/B5mpLd0FP8lEImVa2H1uAQJOPsS4F8HjHj8-dIrJIIhuouGlU65-tAjSfhc7zzIXaHt9CHJDMY7R868rnKa0qBMigZdfNjQq-lbO0Ckq-FXvdgnrWVCighnwPviyWAGhFIZVCTH_xiQgcu0NB9v9TBz1gOmQQ5rVUHfzw-QnGnNbnw_7EYKjoT_xv0zXctyu11_V4AVPiX7fRtRQYM4Yuaj70SI3oSMbgDZmXZLMCzTjrUwRv5qI2GajjmNqsZ9fyuEuH34Z3VUPOGjGezGmgeZvJ1HT6DOSm8eXt8-d45OVDzOuYuap9wnS3_u_0BGpPkFihFVsEP7N_nAFBck1uZGNmbv7_3xRoBKJ_dFL-qC1Ii6otWx7JMeFjMHX7hjMMASJ41E3rTv0yUPs1CsLhena3v0RSVEdrK2O27grzCI9Qc3EMsYLTkz947kX3SZGAzGNxZ7SCHEKJChNrSkfkYlzr3EJ4Qeo-RHMxhWThmkdD2ADGlqSFUyJbhDanJTqk8S5_F52TwrQei6Gw89u9nzcMQa_WnUXYJK0YHq0UuvxYXFMtw7RGnNeV_SnR4NSCpzgU3ASYrS8aSrkSrm6ZnUp-ywm303TjAl1bl6DAS0EkxmXEyBkT3Ma7xm4Iz802yYgCSfScl8Cb3SrYyiBsm8veehexX97bMs0rS8fEpQuFJI5tR-oBw=w560-h420-no)  

![](https://lh3.googleusercontent.com/CUQ3GLXFgjQZ_7vul9YvUHQP6N4OMFUwhGkGjzqGlV3ni0P_QKrsNzuna9bEGzN6Q94ojpq5REmA0uHCMtqGz4tnDKH_GFnSCA3jjAfcBDxhDqHo6EQwlGlZk2wC5nQe-qvJdRAFS_X6fMNdyno8U82rN5nT_CErlzmHPDAW5lJRRC5MX8KM9UOzNKhOdraEf4-eh2BlCubWswmUwzFtVAHMRiQFpq8b2sLGBY0-pvgRLjlzO9_cfRUu6tiH9efYr9FAcYDWRhMP9VyivaSpUkgY3X-WZwAYIcgeIrqyGl4lA87bnMbQKTbe9jkXGCVefPYH_I-3jgb9p5wzqNujFaAGGd3AhO1GeVEexfAdQIRM9GBuWrH2GQWnheswb6gHvUWPLS4LrXjHk8tJ899SsmowVeihhq7Imj5GUwNw834DhAge0x9171pVd7raEY1T5KY9Et12Gb1jxo_4caPqRIVZ3m5DueRqu6j14BDMUPLdhOpagoODjiKI9eEG_SGeCLm296ONeY1zVCGGi3lEdW1RjzTJzrU1prydWA5S-3zi2bxnDAif8eCr7uItbBJoWxQMtvXKdE13_vI9f0j3VoTGZ4OYmJEtIndXkTYcrGNN7i631SHlfXWUc3KGRvXQacFVf70WLt-ZcZhPoul88sctHr7QtE7r4Iu9gggxLzah9oUOMViTAw=w560-h420-no)  

### Exact Solutions and Discussion of Differences Between Linear and Quadratic Approximations

The exact solution and the dudx equation are as follows.  

![](https://latex.codecogs.com/gif.latex?u%28x%29%20%3D%20%5Cfrac%7B1%7D%7BEA%7D%5Cleft%20%5B-%5Cfrac%7B5000x%5E%7B3%7D%7D%7B6%7D%20&plus;%20%5Cfrac%7B10x%7D%7B3%7D%20%5Cright%20%5D)  

![](https://latex.codecogs.com/gif.latex?%5Cfrac%7Bdu%7D%7Bdx%7D%20%3D%20%5Cfrac%7B1%7D%7BEA%7D%5Cleft%20%5B-%5Cfrac%7B5000x%5E%7B2%7D%7D%7B2%7D%20&plus;%20%5Cfrac%7B10%7D%7B3%7D%20%5Cright%20%5D)  

The clear difference between both the displacement and strain estimations using linear or quadratic elements are the accuracy. Just by comparing the displacement graphs, it can be seen that quadratic elements "fit" better and are generally more accurate than linear elements. A possible reason for this is that the exact solution is a cubic polynomial and a quadratic estimation will naturally be more accurate. Furthermore, strain estimation using linear elements results in constant strains over the element length; a wildly inaccurate value. The estimation using quadratic elements, though not perfect, have a much better shape match. 
